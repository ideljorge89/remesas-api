{% trans_default_domain 'FOSUserBundle' %}
<link rel="stylesheet" href="{{ asset('assets/frontend/js/plugins/intl-tel-input/intlTelInput.css') }}"
      type="text/css">
<style>
    .modal-body .tabs-list > li {
        background-color: white;
        color:black;
    }
    .modal-body .tabs-list > li > a{
        background-color: white !important;
        color:black;
    }
    .modal-body .tabs-list > li > a > h1{
        font-size: 15px!important;
        color:#ab0058;
        opacity: .8;
    }

    .modal-body .tabs-list > li.active > a > h1{
        font-size: 25px!important;
        color:#ab0058;
        opacity: 1;
    }

    .modal-body .tabs-list > li:hover, .tabs-list > li:focus{
        color:#ab0058;
    }

    .modal-body .chosen-container.chosen-container-single {
        background-color: #fff;
        border: medium none;
        border-radius: 1px;
        box-shadow: 0 0 0 2px rgba(0, 0, 0, 0.1), 1px 0 5px rgba(0, 0, 0, 0.03) inset;
        font-size: 14px;
        font-weight: 400;
        height: inherit;
        outline: medium none !important;
        padding: 8px 0 8px 12px;
        transition: all 0.3s ease 0s;
        width: 100%;
    }

    .modal-body .chosen-container.chosen-container-single > a.chosen-single {
        background: transparent none repeat scroll 0 0;
        border: 0 none;
        border-radius: 0;
        box-shadow: none !important;
    }

    .modal-body .chosen-container.chosen-container-single > .chosen-drop {
        border: medium none;
    !important;
    }
    .modal-body .intl-tel-input {
        display: inherit;
        position: relative;
    }
    .modal-body .radio-inline, .checkbox-inline {
        padding-left: 0px;
    }

    .login_form {
        margin-left: 20%;
        width: 60%;
    }

    .nav-tabs > li {
        width: inherit ;
    }

    .nav li a.login-modal-user-account {
        text-align: center;
        width: 300px;
    }

    @media (max-width: 380px) {
        .nav li a.login-modal-user-account {
            width: auto;
        }
    }

    @media (max-width: 600px) {
        .login_form {
            margin-left: auto;
            width: 100%;
        }
    }
</style>
<link rel="stylesheet" href="{{ asset('assets/frontend/js/plugins/intl-tel-input/intlTelInput.css') }}"
      type="text/css">

<div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>

</div>
<!--end modal-header-->
<div class="modal-body">
    <ul class="nav nav-tabs tabs-list" role="tablist">
        <li role="presentation" class="pull-right">
            <a href="#tab-register" class="login-modal-user-account" aria-controls="tab-register" role="tab" data-toggle="tab" >
                <h1 class="title"> <i class="fa fa-user"></i> {{ 'form.create_your_account' | trans }} </h1>
            </a>
        </li>
        <li role="presentation" class="active pull-left">
            <a href="#tab-sign-in" aria-controls="tab-sign-in" role="tab" data-toggle="tab" style="text-align: center;">
                <h1 class="title">{{ 'security.login.log_in'|trans }}</h1>
            </a>
        </li>
    </ul>
    <div class="tab-content">
        <div role="tabpanel" class="tab-pane fade in active " id="tab-sign-in">
            <form action="{{ path("fos_user_security_check") }}" method="post" role="form" class="login_form">


                <div class="form-group">
                    {#<label for="sender-email"
                           class="control-label">{{ 'security.login.username'|trans }}</label>#}
                    <div class="input-group m-b">
                        <span class="input-group-addon"><i class="fa fa-user"></i></span>
                        <input id="username" type="text" name="_username"
                               required="required" placeholder="{{ 'security.login.username'|trans }}"
                               class="form-control email">
                    </div>
                </div>

                <div class="form-group">
                    {#<label for="user-pass" class="control-label">{{ 'security.login.password'|trans }}</label>#}
                    <div class="input-group m-b">
                        <span class="input-group-addon"><i class="fa fa-lock"></i></span>
                        <input type="password" class="form-control"
                               placeholder="{{ 'security.login.password'|trans }}" id="password"
                               name="_password" required="required">
                    </div>
                </div>
                {#<input type="hidden" name="_csrf_token" value="{{ csrf_token }}"/>#}
                <div class="clearfix action">
                    <div class="form-group text-center">
                        <input type="submit" id="_submit" name="_submit" value="{{ 'security.login.submit'|trans }}" class="btn btn-primary btn-rounded btn-lg"/>
                    </div>
                </div>
                {#<div class="checkbox pull-left">#}
                {#<label> <input type="checkbox" id="remember_me" name="_remember_me" value="on"> {{ 'security.login.remember_me'|trans }}</label>#}
                {#</div>#}


                <a href="{{ path('fos_user_resetting_request') }}"><small>{{ 'security.login.lost_your_password_question'|trans }}</small></a>

                {#<p class="text-muted text-center"><small>Do not have an account?</small></p>#}
                {#<a class="btn btn-sm btn-white btn-block" href="register.html">Create an account</a>#}
            </form>
        </div>
        <div role="tabpanel" class="tab-pane fade" id="tab-register">
            <div class="row">
                <div class="col-md-6">
                    <p class="well" style="margin-bottom: 20px;margin-top: 20px;line-height: 1.5; text-align: justify; text-indent: 4px; unicode-bidi: normal;">
                        <span class="col-md-12 center">
                            <i class="fa fa-5x fa-sign-in" style="color:#AA0258;"></i>
                        </span>   {{ 'registration.register_text_client'|trans }}
                    </p>
                </div>
                <div class="col-md-6">
                    <form id="{{ form.vars.id }}" action="{{ path('fos_user_registration_register') }}"  method="POST" >
                        {{ form_row(form._token) }}
                        {% if form_errors(form) %}
                            <div class="text-danger well well-sm" role="alert">
                                <span class="fa fa-exclamation" aria-hidden="true"></span>
                                <span class="sr-only">Error:</span>
                                {{ form_errors(form) | striptags }}
                            </div>
                        {% endif %}
                        <div class="form-group required">
                            <label class="control-label">{{ form_label(form.username) | striptags }} <sup>*</sup></label>
                            {{ form_widget(form.username, { 'attr': {'class': 'form-control'} }) }}
                            {% if form_errors(form.username) %}
                                <p class="help-block"><i class="fa fa-exclamation-circle "></i> {{ form_errors(form.username) | striptags }}</p>
                            {% endif %}
                        </div>
                        <div class="form-group required">
                            <label class="control-label">{{ form_label(form.email) | striptags }} <sup>*</sup></label>
                            {{ form_widget(form.email, { 'attr': {'class': 'form-control'} }) }}
                            {% if form_errors(form.email) %}
                                <p class="help-block"><i class="fa fa-exclamation-circle "></i> {{ form_errors(form.email) | striptags }}</p>
                            {% endif %}
                        </div>
                        <div class="form-group required">
                            <label class="control-label">{{ form_label(form.plainPassword.first) | striptags }} <sup>*</sup>
                                <i class="fa fa-info-circle " data-toggle='tooltip' style="color: #AA0258" data-placement="bottom" title="{{ 'form.password.invalid' | trans }}"></i></label>
                            {{ form_widget(form.plainPassword.first, { 'attr': {'class': 'form-control'} }) }}
                            {% if form_errors(form.plainPassword.first) %}
                                <p class="help-block"><i class="fa fa-exclamation-circle "></i> {{ form_errors(form.plainPassword.first) | striptags }}</p>
                            {% endif %}
                        </div>
                        <div class="form-group required">
                            <label class="control-label">{{ form_label(form.plainPassword.second) | striptags }} <sup>*</sup></label>
                            {{ form_widget(form.plainPassword.second, { 'attr': {'class': 'form-control'} }) }}
                            {% if form_errors(form.plainPassword.second) %}
                                <p class="help-block"><i class="fa fa-exclamation-circle "></i> {{ form_errors(form.plainPassword.second) | striptags }}</p>
                            {% endif %}
                        </div>
                        <div class="form-group required">
                            <label class="control-label">{{ form_label(form.profile.name) | striptags }} <sup>*</sup></label>
                            {{ form_widget(form.profile.name, { 'attr': {'class': 'form-control'} }) }}
                            {% if form_errors(form.profile.name) %}
                                <p class="help-block"><i class="fa fa-exclamation-circle "></i> {{ form_errors(form.profile.name) | striptags }}</p>
                            {% endif %}
                        </div>
                        <div class="form-group required ">
                            <label class="control-label">{{ form_label(form.profile.annoNacimiento) | striptags }}</label>
                            {{ form_widget(form.profile.annoNacimiento, { 'attr': {
                                'class': 'form-control',
                                'data-error-to':'#error_'~form.profile.annoNacimiento.vars.id
                            } }) }}
                            <span id="{{ 'error_'~form.profile.annoNacimiento.vars.id }}">
                                {% if form_errors(form.profile.annoNacimiento) %}
                                    <p class="error"><i class="fa fa-exclamation-circle "></i> {{ form_errors(form.profile.annoNacimiento) | striptags }}</p>
                                {% endif %}
                            </span>
                        </div>
                        <div class="form-group required">
                            <label class="control-label">{{ form_label(form.profile.phone) | striptags }}</label>
                            {{ form_widget(form.profile.phone, { 'attr': {
                                'class': 'form-control',
                                'data-error-to':'#phone_error'

                            } }) }}
                            {{ form_widget(form.profile.phone_hidden) }}
                            <span id="phone_error">
                                {% if form_errors(form.profile.phone) %}
                                    <p class="error"><i class="fa fa-exclamation-circle "></i> {{ form_errors(form.profile.phone) | striptags }}</p>
                                {% endif %}
                            </span>
                        </div>
                        <div class="form-group">
                            <div class="">
                                <label for="checkboxes-1" class="checkbox-inline">
                                    {{ form_widget(form.terms,{'attr':{
                                        'data-error-to':'#terminos'
                                    }}) }}
                                    <div class="col-sm-10 pull-right" style="text-align: justify; padding-left: 0px">
                                        {{ form.terms.vars.label |trans({'%url%':path('homepage_terms')})| raw }}
                                    </div>
                                </label>
                                <span class="" id="terminos">
                                    {% if form_errors(form.terms) %}
                                        <p class="error"><i class="fa fa-exclamation-circle "></i> {{ form_errors(form.terms) | striptags }}</p>
                                    {% endif %}
                                </span>

                            </div>
                        </div>
                        {{ form_widget(form.type) }}
                        <!--end form-group-->
                        <div class="clearfix action">
                            <div class="form-group text-center">
                                <button type="submit" class="btn btn-primary btn-rounded btn-lg">{{ 'registration.submit'|trans }}</button>
                            </div>
                        </div>
                        <!--end action-->
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="{{ asset('assets/frontend/js/plugins/intl-tel-input/intlTelInput.js') }}"></script>
<script src="{{ asset('assets/frontend/js/plugins/intl-tel-input/utils.js') }}"></script>
<script>

    $(function () {

        $("input[type=checkbox]").iCheck();
        $("#{{ form.profile.annoNacimiento.vars.id }}").chosen({
            width:'100%'
        })

        $.validator.setDefaults({ignore: ":hidden:not(select)"})

        $.validator.addMethod("checkPhone", function (value, element) {
            return $("#{{ form.profile.phone.vars.id }}").intlTelInput("isValidNumber")
        }, $.validator.messages.phone);

        $("#{{ form.profile.phone.vars.id }}").intlTelInput({
            initialCountry: "auto",
            geoIpLookup: function (callback) {
                $.get('https://ipinfo.io', function () {
                }, "jsonp").always(function (resp) {
                    var countryCode = (resp && resp.country) ? resp.country : "";
                    callback(countryCode);
                });
            },
            utilsScript: "{{ asset('assets/frontend/js/plugins/intl-tel-input/utils.js') }}" // just for formatting/placeholders etc
        });

        $("#{{ form.vars.id }}").validate({
            validateNonVisibleFields: true,
            submitHandler: function (form) {
                $("#{{ form.profile.phone_hidden.vars.id }}")
                        .val(
                        $("#{{ form.profile.phone.vars.id }}").intlTelInput("getNumber")
                );
                form.submit();
            },
            rules: {
                '{{ form.username.vars.full_name }}': {
                    required: true,
                },
                '{{ form.email.vars.full_name }}': {
                    required: true,
                }, '{{ form.plainPassword.first.vars.full_name }}': {
                    required: true,
                }, '{{ form.plainPassword.second.vars.full_name }}': {
                    required: true,
                    equalTo:'#{{ form.plainPassword.first.vars.id }}'
                }
            },
            messages:{
                '{{ form.plainPassword.first.vars.full_name }}': {
                    required:'{{ 'fos_user.password.blank'|trans({},'validators') }}'
                }
            },
            errorPlacement: function (error, element) {
                if ($(element).data('error-to'))
                    $($(element).data('error-to')).append(error)
                else
                    error.insertAfter(element)
            }
        });

    })
</script>
